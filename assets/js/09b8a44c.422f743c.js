"use strict";(self.webpackChunkmapml_viewer_doc=self.webpackChunkmapml_viewer_doc||[]).push([[5977],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),o=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=o(e.components);return a.createElement(p.Provider,{value:t},e.children)},h="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,p=e.parentName,m=r(e,["components","mdxType","originalType","parentName"]),h=o(n),c=i,u=h["".concat(p,".").concat(c)]||h[c]||d[c]||l;return n?a.createElement(u,s(s({ref:t},m),{},{components:n})):a.createElement(u,s({ref:t},m))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,s=new Array(l);s[0]=c;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r[h]="string"==typeof e?e:i,s[1]=r;for(var o=2;o<l;o++)s[o]=n[o];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2495:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>o});var a=n(7462),i=(n(7294),n(3905));const l={id:"using-styles",title:"Using mvt styles",slug:"/user-guide/using-styles"},s=void 0,r={unversionedId:"user-guide/using-styles",id:"user-guide/using-styles",title:"Using mvt styles",description:"The declarative `` API",source:"@site/docs/user-guide/using-styles.md",sourceDirName:"user-guide",slug:"/user-guide/using-styles",permalink:"/web-map-doc/docs/user-guide/using-styles",draft:!1,tags:[],version:"current",frontMatter:{id:"using-styles",title:"Using mvt styles",slug:"/user-guide/using-styles"},sidebar:"sidebar",previous:{title:"Creating custom mvt styles",permalink:"/web-map-doc/docs/user-guide/creating-styles"},next:{title:"MapML Introduction",permalink:"/web-map-doc/docs/user-guide/getting-started"}},p={},o=[{value:"The declarative <code>&lt;map-link&gt;</code> API",id:"the-declarative-map-link-api",level:2},{value:"application/pmtiles+stylesheet modules",id:"applicationpmtilesstylesheet-modules",level:2},{value:"Search order for linked stylesheets",id:"search-order-for-linked-stylesheets",level:2}],m={toc:o},h="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(h,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"the-declarative-map-link-api"},"The declarative ",(0,i.kt)("inlineCode",{parentName:"h2"},"<map-link>")," API"),(0,i.kt)("p",null,"The developer-user interface to use mvt styling in the MapML polyfill is similar to (one of the ways) how CSS stylesheets are imported into\nan HTML document, by using the ","<","map-link",">"," element.  A templated ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-link>")," to a pmtiles or mvt resource will be associated with a",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link type="application/pmtiles+stylesheet">')," stylesheet link in its DOM ancestry:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'...\n<map-extent units="OSMTILE" checked="checked" hidden="hidden">\n  <map-link id="linked-stylesheet" rel="stylesheet" type="application/pmtiles+stylesheet" href="lightTheme.js"></map-link>\n  <map-link id="templated-link" rel="tile" type="application/pmtiles" \n    tref="https://maps4html.org/experiments/vector-tiles/pmtiles/spearfish.pmtiles?theme=light"></map-link>\n</map-extent>\n...\n')),(0,i.kt)("p",null,"In the above example the ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link id="templated-link">')," will be ",(0,i.kt)("a",{parentName:"p",href:"#search-order-for-linked-stylesheets"},"associated")," with the stylesheet link ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link id="linked-stylesheet">'),"."),(0,i.kt)("h2",{id:"applicationpmtilesstylesheet-modules"},"application/pmtiles+stylesheet modules"),(0,i.kt)("p",null,"The stylesheet resource above, ",(0,i.kt)("inlineCode",{parentName:"p"},"lightTheme.js")," which can be any name, but must be ",(0,i.kt)("strong",{parentName:"p"},"structured")," as a JavaScript module, for consumption by the polyfill as described\nin ",(0,i.kt)("a",{parentName:"p",href:"creating-styles"},"the previous section"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"const pmtilesRules = new Map();\npmtilesRules.set(\n  'https://maps4html.org/experiments/vector-tiles/pmtiles/spearfish.pmtiles?theme=light',\n  { theme: { theme: 'light' } }\n);\nexport { pmtilesRules };\n")),(0,i.kt)("p",null,"The module ",(0,i.kt)("strong",{parentName:"p"},"must")," define an export named ",(0,i.kt)("inlineCode",{parentName:"p"},"pmtilesRules")," which ",(0,i.kt)("strong",{parentName:"p"},"must")," be of\n",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"},"type Map"),". Each entry in the Map must be the\n",(0,i.kt)("strong",{parentName:"p"},"exact")," URL template string ",(0,i.kt)("inlineCode",{parentName:"p"},"tref")," value of the resource(s) from which mvt tiles will be obtained.  "),(0,i.kt)("p",null,"The reason that the Map key must be the exact string value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"tref")," URL template is because the polyfill will use the URL template string\nfound in the ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link tref="...">')," ",(0,i.kt)("inlineCode",{parentName:"p"},"tref")," attribute as a key to ",(0,i.kt)("strong",{parentName:"p"},"look up")," the style rules in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pmtilesRules")," Map that should be applied to the content. "),(0,i.kt)("p",null,"Each ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link type="application/pmtiles"...>')," or ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link type="application/vnd.mapbox-vector-tile"...>'),"\nyou create should have an associated set of style rules or a theme.  The subject of how to encode style rules and themes was discussed in the previous\nsection. "),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Pre-defined themes that you can use include: ",(0,i.kt)("inlineCode",{parentName:"p"},"light"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dark"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"white"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"grayscale")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"black"),". You should include the theme name in the URL template as a parameter (even though it is not required by the pmtiles or mvt resource), so that the URL template can be made unique and distinct from other pmtilesRules keys' use of the same pmtiles or mvt resource.")),(0,i.kt)("h2",{id:"search-order-for-linked-stylesheets"},"Search order for linked stylesheets"),(0,i.kt)("p",null,"The styles for a given ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-link>"),"'s URL template ",(0,i.kt)("inlineCode",{parentName:"p"},"tref")," must be found via an associated ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-link rel=stylesheet>"),".  The MapML\npolyfill looks for the associated ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-link rel=stylesheet>")," upward in the ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-link>"),' element\'s "ancestry", stopping at the\nenclosing ',(0,i.kt)("inlineCode",{parentName:"p"},"<layer->")," element. The associated stylesheet link ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link rel="stylesheet" type="application/pmtiles+stylesheet"...>'),"\nmay be located within the enclosing ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-extent>"),", as a sibling of the to-be-styled ",(0,i.kt)("inlineCode",{parentName:"p"},'<map-link rel="tile" tref="...">')," resource, or\nwithin the ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-head>")," (when used in remote MapML content) or ",(0,i.kt)("inlineCode",{parentName:"p"},"<layer->")," element (when used in local MapML content).  Only the\n",(0,i.kt)("strong",{parentName:"p"},"first")," ",(0,i.kt)("inlineCode",{parentName:"p"},"<map-link rel=stylesheet>")," in document order found will be associated; if no style rules or theme for the\n",(0,i.kt)("inlineCode",{parentName:"p"},"tref")," URL template is found, console error messages may help clarify."),(0,i.kt)("p",null,"Example of where linked stylesheets are sought by the polyfill, remote content:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<mapml- xmlns="http://www.w3.org/1999/xhtml">\n  <map-head>\n    <map-title>pmtiles</map-title>\n\n    <map-link data-testid="operative-light" rel="stylesheet" type="application/pmtiles+stylesheet" href="lightTheme.js"></map-link>\n\n    \x3c!-- only the first stylesheet in document order within the container search path is used... --\x3e\n    <map-link data-testid="inoperative-dark" rel="stylesheet" type="application/pmtiles+stylesheet" href="darkTheme.js"></map-link>\n\n    <map-link rel="license" title="\xa9 OpenStreetMap contributors CC BY-SA" href="https://www.openstreetmap.org/copyright"></map-link>\n  </map-head>\n  <map-body>\n    <map-extent data-testid="light-me" label="light" units="OSMTILE" >\n\n      \x3c!-- this guy should use the operative-light stylesheet in the map-head --\x3e\n      <map-link rel="tile" type="application/pmtiles" tref="spearfish.pmtiles?theme=light"></map-link>\n\n    </map-extent>\n    <map-extent data-testid="dark-me" label="dark" units="OSMTILE" checked="checked" >\n\n      <map-link data-testid="operative-dark" rel="stylesheet" type="application/pmtiles+stylesheet" href="darkTheme.js"></map-link>\n      <map-link data-testid="inoperative-light" rel="stylesheet" type="application/pmtiles+stylesheet" href="lightTheme.js"></map-link>\n      \n      \x3c!-- this guy should use the preceding sibling operative-dark stylesheet (first in doc order in search path) --\x3e\n      <map-link rel="tile" type="application/pmtiles" tref="spearfish.pmtiles?theme=dark"></map-link>\n\n    </map-extent>\n  </map-body>\n</mapml->\n')),(0,i.kt)("p",null,"Example of where linked stylesheets are sought by the polyfill, local content:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'...\n<mapml-viewer data-testid="viewer" projection="OSMTILE" zoom="0" lat="0" lon="0" width="400" height="400">\n  <layer- data-testid="dark">\n    <map-title>PMTiles test dark</map-title>\n    <map-link rel="license" title="\xa9 OpenStreetMap contributors CC BY-SA" href="https://www.openstreetmap.org/copyright"></map-link>\n    <map-extent units="OSMTILE" checked>\n      \x3c!-- linked stylesheet is a sibling child of map-extent --\x3e\n      <map-link rel="stylesheet" type="application/pmtiles+stylesheet" href="pmtilesRulesModule.js"></map-link>\n      <map-link rel="tile" type="application/pmtiles" tref="spearfish.pmtiles?theme=dark"></map-link>\n    </map-extent>\n  </layer->\n  <layer- checked data-testid="light">\n    <map-title>{z}/{x}/{y}.mvt test</map-title>\n    \x3c!-- no map-head available, layer- element children are searched for linked stylesheets --\x3e\n    <map-link rel="stylesheet" type="application/pmtiles+stylesheet" href="pmtilesRulesModule.js"></map-link>\n    <map-extent units="OSMTILE" checked="checked">\n      <map-input name="beans" type="zoom" value="18" min="0" max="2"></map-input>\n      <map-input name="foo" type="location" units="tilematrix" axis="column" min="0" max="262144"></map-input>\n      <map-input name="bar" type="location" units="tilematrix" axis="row" min="0" max="262144"></map-input>\n      <map-link rel="tile" type="application/vnd.mapbox-vector-tile" tref="tiles/osmtile/{beans}/{foo}/{bar}.mvt?theme=light"></map-link>\n    </map-extent>\n  </layer->\n</mapml-viewer>\n')))}d.isMDXComponent=!0}}]);