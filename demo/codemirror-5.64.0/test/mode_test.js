!function(){function t(t,e,n){for(;;){var r=t.indexOf(n,e);if(-1==r)return null;if(t.charAt(r+1)!=n)return r;e=r+2}}var e=/[\w&-_]+/g;function n(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function r(t){return window.JSON&&JSON.stringify?JSON.stringify(t,(function(t,e){if("function"==typeof e){var n=e.toString().match(/function\s*[^\s(]*/);return n?n[0]:"function"}return e}),2):"[unsupported]"}function a(t,e){var r='<table class="mt-output">';r+="<tr>";for(var a=0;a<t.length;++a){var l=t[a].style,i=t[a].text;r+='<td class="mt-token"'+(a==e?" style='background: pink'":"")+'><span class="cm-'+n(String(l))+'">'+n(i.replace(/ /g,"\xb7"))+"</span></td>"}r+="</tr><tr>";for(a=0;a<t.length;++a)r+='<td class="mt-style"><span>'+(t[a].style||null)+"</span></td>";if(t[0].state){r+='</tr><tr class="mt-state-row" title="State AFTER each token">';for(a=0;a<t.length;++a)r+='<td class="mt-state"><pre>'+n(t[a].state)+"</pre></td>"}return r+="</tr></table>"}test.mode=function(l,i,s,o){var u=function(n){for(var r=[],a="",l=0;l<n.length;++l){l&&(a+="\n");for(var i=n[l],s=0;s<i.length;){var o,u=null;if("["==i.charAt(s)&&"["!=i.charAt(s+1)){e.lastIndex=s+1;var c=s+(u=e.exec(i)[0].replace(/&/g," ")).length+2;if(null==(f=t(i,c,"]")))throw new Error("Unterminated token at "+s+" in '"+i+"'"+u);o=i.slice(c,f),s=f+1}else{var f;null==(f=t(i,s,"["))&&(f=i.length),o=i.slice(s,f),s=f}o=o.replace(/\[\[|\]\]/g,(function(t){return t.charAt(0)})),r.push({style:u,text:o}),a+=o}}return{tokens:r,plain:a}}(s);return test((o||i.name)+"_"+l,(function(){return function(t,e,l){for(var i=[],s=0;s<e.length;++s){var o=e[s].style;o&&o.indexOf(" ")&&(o=o.split(" ").sort().join(" ")),i.push({style:o,text:e[s].text})}var u=function(t,e){for(var n=e.startState(),a=t.replace(/\r\n/g,"\n").split("\n"),l=[],i=0,s=0;s<a.length;++s){var o=a[s],u=!0;if(e.indent){var c=o.match(/^\s*/)[0],f=e.indent(n,o.slice(c.length),o);f!=CodeMirror.Pass&&f!=c.length&&(l.indentFailures||(l.indentFailures=[])).push("Indentation of line "+(s+1)+" is "+f+" (expected "+c.length+")")}var d=new CodeMirror.StringStream(o,4,{lookAhead:function(t){return a[s+t]}});for(""==o&&e.blankLine&&e.blankLine(n);!d.eol();){for(var p=0;p<10&&d.start>=d.pos;p++)var h=e.token(d,n);if(10==p)throw new Failure("Failed to advance the stream."+d.string+" "+d.pos);var g=d.current();if(h&&h.indexOf(" ")>-1&&(h=h.split(" ").sort().join(" ")),d.start=d.pos,i&&l[i-1].style==h&&!u?l[i-1].text+=g:g&&(l[i++]={style:h,text:g,state:r(n)}),d.pos>5e3){l[i++]={style:null,text:this.text.slice(d.pos)};break}u=!1}}return l}(t,l),c="",f=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;++r)if(t[r].style!=e[r].style||t[r].text!=e[r].text)return r;if(t.length>n||e.length>n)return n}(i,u);null!=f&&(c+='<div class="mt-test mt-fail">',c+="<pre>"+n(t)+"</pre>",c+='<div class="cm-s-default">',c+="expected:",c+=a(i,f),c+="observed: [<a onclick=\"this.parentElement.className+=' mt-state-unhide'\">display states</a>]",c+=a(u,f),c+="</div>",c+="</div>");if(u.indentFailures)for(s=0;s<u.indentFailures.length;s++)c+="<div class='mt-test mt-fail'>"+n(u.indentFailures[s])+"</div>";if(c)throw new Failure(c)}(u.plain,u.tokens,i)}))}}();