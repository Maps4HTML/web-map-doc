{"version":3,"file":"map-extent.js","sources":["../src/map-extent.js"],"sourcesContent":["export class MapExtent extends HTMLElement {\n  static get observedAttributes() {\n    return ['units', 'checked', 'label', 'opacity'];\n  }\n  get units() {\n    return this.getAttribute('units');\n  }\n  set units(val) {\n    // built in support for OSMTILE, CBMTILE, WGS84 and APSTILE\n    if (['OSMTILE', 'CBMTILE', 'WGS84', 'APSTILE'].includes(val)) {\n      this.setAttribute('units', val);\n    }\n    // else need to check with the mapml-viewer element if the custom projection is defined\n  }\n  get checked() {\n    return this.hasAttribute('checked');\n  }\n\n  set checked(val) {\n    if (val) {\n      this.setAttribute('checked', '');\n    } else {\n      this.removeAttribute('checked');\n    }\n  }\n  get label() {\n    return this.hasAttribute('label') ? this.getAttribute('label') : '';\n  }\n  set label(val) {\n    if (val) {\n      this.setAttribute('label', val);\n    }\n  }\n  get opacity() {\n    return this._opacity;\n  }\n\n  set opacity(val) {\n    if (+val > 1 || +val < 0) return;\n    this.setAttribute('opacity', val);\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    switch (name) {\n      case 'units':\n        if (oldValue !== newValue) {\n          // handle side effects\n        }\n        break;\n      case 'label':\n        if (oldValue !== newValue) {\n          // handle side effects\n        }\n        break;\n      case 'checked':\n        if (oldValue !== newValue) {\n          // handle side effects\n        }\n        break;\n      case 'opacity':\n        if (oldValue !== newValue) {\n          // handle side effects\n        }\n        break;\n    }\n  }\n  constructor() {\n    // Always call super first in constructor\n    super();\n  }\n  connectedCallback() {\n    if (\n      this.querySelector('map-link[rel=query], map-link[rel=features]') &&\n      !this.shadowRoot\n    ) {\n      this.attachShadow({ mode: 'open' });\n    }\n    let parentLayer =\n      this.parentNode.nodeName.toUpperCase() === 'LAYER-'\n        ? this.parentNode\n        : this.parentNode.host;\n    parentLayer\n      .whenReady()\n      .then(() => {\n        this._layer = parentLayer._layer;\n      })\n      .catch(() => {\n        throw new Error('Layer never became ready');\n      });\n  }\n  disconnectedCallback() {}\n  whenReady() {\n    return new Promise((resolve, reject) => {\n      let interval, failureTimer;\n      if (this._layer) {\n        resolve();\n      } else {\n        let extentElement = this;\n        interval = setInterval(testForExtent, 300, extentElement);\n        failureTimer = setTimeout(extentNotDefined, 10000);\n      }\n      function testForExtent(extentElement) {\n        if (extentElement._layer) {\n          clearInterval(interval);\n          clearTimeout(failureTimer);\n          resolve();\n        }\n      }\n      function extentNotDefined() {\n        clearInterval(interval);\n        clearTimeout(failureTimer);\n        reject('Timeout reached waiting for extent to be ready');\n      }\n    });\n  }\n}\n"],"names":["MapExtent","HTMLElement","observedAttributes","units","this","getAttribute","val","includes","setAttribute","checked","hasAttribute","removeAttribute","label","opacity","_opacity","attributeChangedCallback","name","oldValue","newValue","constructor","super","connectedCallback","querySelector","shadowRoot","attachShadow","mode","let","parentLayer","parentNode","nodeName","toUpperCase","host","whenReady","then","_layer","catch","Error","disconnectedCallback","Promise","resolve","reject","interval","failureTimer","setInterval","extentElement","clearInterval","clearTimeout","setTimeout"],"mappings":";;MAAaA,kBAAkBC,YAC7BC,gCACE,MAAO,CAAC,QAAS,UAAW,QAAS,WAEvCC,YACE,OAAOC,KAAKC,aAAa,SAE3BF,UAAUG,GAEJ,CAAC,UAAW,UAAW,QAAS,WAAWC,SAASD,IACtDF,KAAKI,aAAa,QAASF,GAI/BG,cACE,OAAOL,KAAKM,aAAa,WAG3BD,YAAYH,GACNA,EACFF,KAAKI,aAAa,UAAW,IAE7BJ,KAAKO,gBAAgB,WAGzBC,YACE,OAAOR,KAAKM,aAAa,SAAWN,KAAKC,aAAa,SAAW,GAEnEO,UAAUN,GACJA,GACFF,KAAKI,aAAa,QAASF,GAG/BO,cACE,OAAOT,KAAKU,SAGdD,YAAYP,GACC,GAANA,IAAYA,EAAM,GACvBF,KAAKI,aAAa,UAAWF,GAE/BS,yBAAyBC,EAAMC,EAAUC,GAC/BF,EAuBVG,cAEEC,QAEFC,oBAEIjB,KAAKkB,cAAc,iDAClBlB,KAAKmB,YAENnB,KAAKoB,aAAa,CAAEC,KAAM,SAE5BC,IAAIC,EACyC,WAA3CvB,KAAKwB,WAAWC,SAASC,cACrB1B,KAAKwB,WACLxB,KAAKwB,WAAWG,KACtBJ,EACGK,YACAC,KAAK,KACJ7B,KAAK8B,OAASP,EAAYO,SAE3BC,MAAM,KACL,MAAM,IAAIC,MAAM,8BAGtBC,wBACAL,YACE,OAAO,IAAIM,QAAQ,CAACC,EAASC,KAC3Bd,IAAIe,EAAUC,EACVtC,KAAK8B,OACPK,KAGAE,EAAWE,YAGb,SAAuBC,GACjBA,EAAcV,SAChBW,cAAcJ,GACdK,aAAaJ,GACbH,MAPoC,IADlBnC,MAEpBsC,EAAeK,WASjB,WACEF,cAAcJ,GACdK,aAAaJ,GACbF,EAAO,mDAZqC,gBAlGvCxC"}