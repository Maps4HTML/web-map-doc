import{runInOp}from"../display/operations.js";import{ensureCursorVisible}from"../display/scrolling.js";import{cmp}from"../line/pos.js";import{replaceRange}from"../model/changes.js";import{lst}from"../util/misc.js";export function deleteNearSelection(e,r){let o=e.doc.sel.ranges,l=[];for(let t=0;t<o.length;t++){let e=r(o[t]);for(;l.length&&cmp(e.from,lst(l).to)<=0;){let r=l.pop();if(cmp(r.from,e.from)<0){e.from=r.from;break}}l.push(e)}runInOp(e,(()=>{for(let r=l.length-1;r>=0;r--)replaceRange(e.doc,"",l[r].from,l[r].to,"+delete");ensureCursorVisible(e)}))}