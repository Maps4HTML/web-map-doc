{"version":3,"file":"web-map.js","sources":["../src/web-map.js"],"sourcesContent":["import './leaflet.js'; // bundled with proj4, proj4leaflet, modularized\nimport './mapml.js';\nimport { MapLayer } from './layer.js';\nimport { MapArea } from './map-area.js';\nimport { MapCaption } from './map-caption.js';\nimport { MapFeature } from './map-feature.js';\nimport { MapExtent } from './map-extent.js';\nimport { MapInput } from './map-input.js';\nimport { MapSelect } from './map-select.js';\nimport { MapLink } from './map-link.js';\nimport { MapStyle } from './map-style.js';\n\nexport class WebMap extends HTMLMapElement {\n  static get observedAttributes() {\n    return [\n      'lat',\n      'lon',\n      'zoom',\n      'projection',\n      'width',\n      'height',\n      'controls',\n      'static',\n      'controlslist'\n    ];\n  }\n  // see comments below regarding attributeChangedCallback vs. getter/setter\n  // usage.  Effectively, the user of the element must use the property, not\n  // the getAttribute/setAttribute/removeAttribute DOM API, because the latter\n  // calls don't result in the getter/setter being called (so you have to use\n  // the getter/setter directly)\n  get controls() {\n    return this.hasAttribute('controls');\n  }\n  set controls(value) {\n    const hasControls = Boolean(value);\n    if (hasControls) {\n      this.setAttribute('controls', '');\n    } else {\n      this.removeAttribute('controls');\n    }\n  }\n  get controlsList() {\n    return this._controlsList;\n  }\n  set controlsList(value) {\n    this._controlsList.value = value;\n    this.setAttribute('controlslist', value);\n  }\n  get width() {\n    return +window.getComputedStyle(this).width.replace('px', '');\n  }\n  set width(val) {\n    //img.height or img.width setters change or add the corresponding attributes\n    this.setAttribute('width', val);\n  }\n  get height() {\n    return +window.getComputedStyle(this).height.replace('px', '');\n  }\n  set height(val) {\n    //img.height or img.width setters change or add the corresponding attributes\n    this.setAttribute('height', val);\n  }\n  get lat() {\n    return +(this.hasAttribute('lat') ? this.getAttribute('lat') : 0);\n  }\n  set lat(val) {\n    if (val) {\n      this.setAttribute('lat', val);\n    }\n  }\n  get lon() {\n    return +(this.hasAttribute('lon') ? this.getAttribute('lon') : 0);\n  }\n  set lon(val) {\n    if (val) {\n      this.setAttribute('lon', val);\n    }\n  }\n  get projection() {\n    return this.hasAttribute('projection')\n      ? this.getAttribute('projection')\n      : 'OSMTILE';\n  }\n  set projection(val) {\n    if (val) {\n      this.whenProjectionDefined(val)\n        .then(() => {\n          this.setAttribute('projection', val);\n        })\n        .catch(() => {\n          throw new Error('Undefined projection:' + val);\n        });\n    }\n  }\n  get zoom() {\n    return +(this.hasAttribute('zoom') ? this.getAttribute('zoom') : 0);\n  }\n  set zoom(val) {\n    var parsedVal = parseInt(val, 10);\n    if (!isNaN(parsedVal) && parsedVal >= 0 && parsedVal <= 25) {\n      this.setAttribute('zoom', parsedVal);\n    }\n  }\n  get layers() {\n    return this.getElementsByTagName('layer-');\n  }\n  get areas() {\n    return this.getElementsByTagName('area');\n  }\n\n  get extent() {\n    let map = this._map,\n      pcrsBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        map.getZoom(),\n        map.options.projection\n      );\n    let formattedExtent = M._convertAndFormatPCRS(\n      pcrsBounds,\n      map.options.crs,\n      this.projection\n    );\n    // get min/max zoom from layers at this moment\n    let minZoom = Infinity,\n      maxZoom = -Infinity;\n    for (let i = 0; i < this.layers.length; i++) {\n      if (this.layers[i].extent) {\n        if (this.layers[i].extent.zoom.minZoom < minZoom)\n          minZoom = this.layers[i].extent.zoom.minZoom;\n        if (this.layers[i].extent.zoom.maxZoom > maxZoom)\n          maxZoom = this.layers[i].extent.zoom.maxZoom;\n      }\n    }\n\n    formattedExtent.zoom = {\n      minZoom: minZoom !== Infinity ? minZoom : map.getMinZoom(),\n      maxZoom: maxZoom !== -Infinity ? maxZoom : map.getMaxZoom()\n    };\n    return formattedExtent;\n  }\n  get static() {\n    return this.hasAttribute('static');\n  }\n  set static(value) {\n    const isStatic = Boolean(value);\n    if (isStatic) this.setAttribute('static', '');\n    else this.removeAttribute('static');\n  }\n\n  constructor() {\n    // Always call super first in constructor\n    super();\n    this._source = this.outerHTML;\n    // create an array to track the history of the map and the current index\n    this._history = [];\n    this._historyIndex = -1;\n    this._traversalCall = false;\n  }\n  connectedCallback() {\n    this.whenProjectionDefined(this.projection)\n      .then(() => {\n        this._initShadowRoot();\n\n        this._controlsList = new M.DOMTokenList(\n          this.getAttribute('controlslist'),\n          this,\n          'controlslist',\n          [\n            'noreload',\n            'nofullscreen',\n            'nozoom',\n            'nolayer',\n            'noscale',\n            'geolocation'\n          ]\n        );\n\n        var s = window.getComputedStyle(this),\n          wpx = s.width,\n          hpx = s.height,\n          w = this.hasAttribute('width')\n            ? this.getAttribute('width')\n            : parseInt(wpx.replace('px', '')),\n          h = this.hasAttribute('height')\n            ? this.getAttribute('height')\n            : parseInt(hpx.replace('px', ''));\n        this._changeWidth(w);\n        this._changeHeight(h);\n\n        this._createMap();\n\n        this._toggleStatic();\n\n        /*\n      1. only deletes aria-label when the last (only remaining) map caption is removed\n      2. only deletes aria-label if the aria-label was defined by the map caption element itself\n    */\n\n        let mapcaption = this.querySelector('map-caption');\n\n        if (mapcaption !== null) {\n          setTimeout(() => {\n            let ariaupdate = this.getAttribute('aria-label');\n\n            if (ariaupdate === mapcaption.innerHTML) {\n              this.mapCaptionObserver = new MutationObserver((m) => {\n                let mapcaptionupdate = this.querySelector('map-caption');\n                if (mapcaptionupdate !== mapcaption) {\n                  this.removeAttribute('aria-label');\n                }\n              });\n              this.mapCaptionObserver.observe(this, {\n                childList: true\n              });\n            }\n          }, 0);\n        }\n      })\n      .catch(() => {\n        throw new Error('Projection not defined');\n      });\n  }\n  _initShadowRoot() {\n    let tmpl = document.createElement('template');\n    /* jshint ignore:start */\n    tmpl.innerHTML = `<link rel=\"stylesheet\" href=\"${\n      new URL('mapml.css', import.meta.url).href\n    }\">`;\n    /* jshint ignore:end */\n\n    const rootDiv = document.createElement('div');\n    rootDiv.classList.add('mapml-web-map');\n\n    let shadowRoot = rootDiv.attachShadow({ mode: 'open' });\n    this._container = document.createElement('div');\n\n    let output =\n      \"<output role='status' aria-live='polite' aria-atomic='true' class='mapml-screen-reader-output'></output>\";\n    this._container.insertAdjacentHTML('beforeend', output);\n\n    // Set default styles for the map element.\n    let mapDefaultCSS = document.createElement('style');\n    mapDefaultCSS.id = 'web-map-default-style';\n    mapDefaultCSS.innerHTML =\n      `[is=\"web-map\"] {` +\n      `all: initial;` + // Reset properties inheritable from html/body, as some inherited styles may cause unexpected issues with the map element's components (https://github.com/Maps4HTML/Web-Map-Custom-Element/issues/140).\n      `contain: layout size;` + // Contain layout and size calculations within the map element.\n      `display: inline-block;` + // This together with dimension properties is required so that Leaflet isn't working with a height=0 box by default.\n      `height: 150px;` + // Provide a \"default object size\" (https://github.com/Maps4HTML/HTML-Map-Element/issues/31).\n      `width: 300px;` +\n      `border-width: 2px;` + // Set a default border for contrast, similar to UA default for iframes.\n      `border-style: inset;` +\n      `box-sizing: inherit;` + // https://github.com/Maps4HTML/Web-Map-Custom-Element/issues/350#issuecomment-888361985\n      `}` +\n      `[is=\"web-map\"][frameborder=\"0\"] {` +\n      `border-width: 0;` +\n      `}` +\n      `[is=\"web-map\"][hidden] {` +\n      `display: none!important;` +\n      `}` +\n      `[is=\"web-map\"] .mapml-web-map {` +\n      `display: contents;` + // This div doesn't have to participate in layout by generating its own box.\n      `}`;\n\n    let shadowRootCSS = document.createElement('style');\n    shadowRootCSS.innerHTML =\n      `:host .leaflet-control-container {` +\n      `visibility: hidden!important;` + // Visibility hack to improve percieved performance (mitigate FOUC) â€“ visibility is unset in mapml.css! (https://github.com/Maps4HTML/Web-Map-Custom-Element/issues/154).\n      `}`;\n\n    // Hide all (light DOM) children of the map element except for the\n    // `<area>` and `<div class=\"mapml-web-map\">` (shadow root host) elements.\n    let hideElementsCSS = document.createElement('style');\n    hideElementsCSS.innerHTML =\n      `[is=\"web-map\"] > :not(area):not(.mapml-web-map) {` +\n      `display: none!important;` +\n      `}`;\n    this.appendChild(hideElementsCSS);\n\n    shadowRoot.appendChild(shadowRootCSS);\n    shadowRoot.appendChild(tmpl.content.cloneNode(true));\n    shadowRoot.appendChild(this._container);\n    this.appendChild(rootDiv);\n    if (this.getRootNode() instanceof ShadowRoot) {\n      if (!this.getRootNode().getElementById(mapDefaultCSS.id))\n        this.getRootNode().prepend(mapDefaultCSS);\n    } else {\n      if (!document.getElementById(mapDefaultCSS.id))\n        document.head.insertAdjacentElement('afterbegin', mapDefaultCSS);\n    }\n  }\n  _createMap() {\n    if (!this._map) {\n      this._map = L.map(this._container, {\n        center: new L.LatLng(this.lat, this.lon),\n        minZoom: 0,\n        maxZoom: M[this.projection].options.resolutions.length - 1,\n        projection: this.projection,\n        query: true,\n        contextMenu: true,\n        announceMovement: M.options.announceMovement,\n        featureIndex: true,\n        mapEl: this,\n        crs: M[this.projection],\n        zoom: this.zoom,\n        zoomControl: false\n      });\n      this._addToHistory();\n\n      this._createControls();\n      this._toggleControls();\n      this._crosshair = M.crosshair().addTo(this._map);\n\n      if (M.options.featureIndexOverlayOption)\n        this._featureIndexOverlay = M.featureIndexOverlay().addTo(this._map);\n\n      if (this.hasAttribute('name')) {\n        var name = this.getAttribute('name');\n        if (name) {\n          this.poster = document.querySelector(\n            'img[usemap=' + '\"#' + name + '\"]'\n          );\n          // firefox has an issue where the attribution control's use of\n          // _container.innerHTML does not work properly if the engine is throwing\n          // exceptions because there are no area element children of the image map\n          // for firefox only, a workaround is to actually remove the image...\n          if (this.poster) {\n            if (L.Browser.gecko) {\n              this.poster.removeAttribute('usemap');\n            }\n            //this.appendChild(this.poster);\n          }\n        }\n      }\n\n      // undisplay the img in the image map, because it's not needed now.\n      // gives a slight FOUC, unless:\n      // 1) the img is pre-styled (https://github.com/Maps4HTML/Web-Map-Custom-Element/blob/80a4a4e372d2ef61bb7cad6a111e17e396b8e908/index-map-area.html#L35)\n      // 2) placed after the map element\n      if (this.poster) {\n        this.poster.setAttribute('hidden', '');\n      }\n\n      // https://github.com/Maps4HTML/Web-Map-Custom-Element/issues/274\n      this.setAttribute('role', 'application');\n      // Make the Leaflet container element programmatically identifiable\n      // (https://github.com/Leaflet/Leaflet/issues/7193).\n      this._container.setAttribute('role', 'region');\n      this._container.setAttribute('aria-label', 'Interactive map');\n\n      this._setUpEvents();\n    }\n  }\n  disconnectedCallback() {\n    this._removeEvents();\n    let rootDiv = this.querySelector('.mapml-web-map');\n    while (rootDiv.shadowRoot.firstChild) {\n      rootDiv.shadowRoot.removeChild(rootDiv.shadowRoot.firstChild);\n    }\n    rootDiv.remove();\n    delete this._map;\n    this._deleteControls();\n  }\n  adoptedCallback() {\n    //    console.log('Custom map element moved to new page.');\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    //    console.log('Attribute: ' + name + ' changed from: '+ oldValue + ' to: '+newValue);\n    // \"Best practice\": handle side-effects in this callback\n    // https://developers.google.com/web/fundamentals/web-components/best-practices\n    // https://developers.google.com/web/fundamentals/web-components/best-practices#avoid-reentrancy\n    // note that the example is misleading, since the user can't use\n    // setAttribute or removeAttribute to set the property, they need to use\n    // the property directly in their API usage, which kinda sucks\n    /*\n  const hasValue = newValue !== null;\n  switch (name) {\n    case 'checked':\n      // Note the attributeChangedCallback is only handling the *side effects*\n      // of setting the attribute.\n      this.setAttribute('aria-checked', hasValue);\n      break;\n    ...\n  }     */\n    switch (name) {\n      case 'controlslist':\n        if (this._controlsList) {\n          if (this._controlsList.valueSet === false) {\n            this._controlsList.value = newValue;\n          }\n          this._toggleControls();\n        }\n        break;\n      case 'controls':\n        if (oldValue !== null && newValue === null) {\n          this._hideControls();\n        } else if (oldValue === null && newValue !== null) {\n          this._showControls();\n        }\n        break;\n      case 'height':\n        if (oldValue !== newValue) {\n          this._changeHeight(newValue);\n        }\n        break;\n      case 'width':\n        if (oldValue !== newValue) {\n          this._changeWidth(newValue);\n        }\n        break;\n      case 'static':\n        this._toggleStatic();\n        break;\n      case 'projection':\n        const reconnectLayers = () => {\n          if (this._map && this._map.options.projection !== newValue) {\n            // save map location and zoom\n            let lat = this.lat;\n            let lon = this.lon;\n            let zoom = this.zoom;\n            // saving the lat, lon and zoom is necessary because Leaflet seems\n            // to try to compensate for the change in the scales for each zoom\n            // level in the crs by changing the zoom level of the map when\n            // you set the map crs.  So, we save the current view for use below\n            // when all the layers' reconnections have settled.\n            // leaflet doesn't like this: https://github.com/Leaflet/Leaflet/issues/2553\n            this._map.options.crs = M[newValue];\n            this._map.options.projection = newValue;\n            let layersReady = [];\n            this._map.announceMovement.disable();\n            for (let layer of this.querySelectorAll('layer-')) {\n              layer.removeAttribute('disabled');\n              let reAttach = this.removeChild(layer);\n              this.appendChild(reAttach);\n              layersReady.push(reAttach.whenReady());\n            }\n            return Promise.allSettled(layersReady).then(() => {\n              // use the saved map location to ensure it is correct after\n              // changing the map CRS.  Specifically affects projection\n              // upgrades, e.g. https://maps4html.org/experiments/custom-projections/BNG/\n              // see leaflet bug: https://github.com/Leaflet/Leaflet/issues/2553\n              this.zoomTo(lat, lon, zoom);\n              if (M.options.announceMovement)\n                this._map.announceMovement.enable();\n              // required to delay until map-extent.disabled is correctly set\n              // which happens as a result of layer-._validateDisabled()\n              // which happens so much we have to delay until they calls are\n              // completed\n              setTimeout(() => {\n                this.dispatchEvent(new CustomEvent('map-projectionchange'));\n              }, 0);\n            });\n          }\n        };\n        if (\n          newValue &&\n          this._map &&\n          this._map.options.projection !== newValue\n        ) {\n          const connect = reconnectLayers.bind(this);\n          connect().then(() => {\n            if (this._map && this._map.options.projection !== oldValue) {\n              // this doesn't completely work either\n              this._resetHistory();\n            }\n            if (this._debug) for (let i = 0; i < 2; i++) this.toggleDebug();\n          });\n        }\n        break;\n    }\n  }\n\n  // Creates All map controls and adds them to the map, when created.\n  _createControls() {\n    let mapSize = this._map.getSize().y,\n      totalSize = 0;\n\n    this._layerControl = M.layerControl(null, {\n      collapsed: true,\n      mapEl: this\n    }).addTo(this._map);\n    this._map.on('movestart', this._layerControl.collapse, this._layerControl);\n\n    let scaleValue = M.options.announceScale;\n\n    if (scaleValue === 'metric') {\n      scaleValue = { metric: true, imperial: false };\n    }\n    if (scaleValue === 'imperial') {\n      scaleValue = { metric: false, imperial: true };\n    }\n\n    if (!this._scaleBar)\n      this._scaleBar = M.scaleBar(scaleValue).addTo(this._map);\n\n    // Only add controls if there is enough top left vertical space\n    if (!this._zoomControl && totalSize + 93 <= mapSize) {\n      totalSize += 93;\n      this._zoomControl = L.control.zoom().addTo(this._map);\n    }\n    if (!this._reloadButton && totalSize + 49 <= mapSize) {\n      totalSize += 49;\n      this._reloadButton = M.reloadButton().addTo(this._map);\n    }\n    if (!this._fullScreenControl && totalSize + 49 <= mapSize) {\n      totalSize += 49;\n      this._fullScreenControl = M.fullscreenButton().addTo(this._map);\n    }\n\n    if (!this._geolocationButton) {\n      this._geolocationButton = M.geolocationButton().addTo(this._map);\n    }\n  }\n\n  // Sets controls by hiding/unhiding them based on the map attribute\n  _toggleControls() {\n    if (this.controls === false) {\n      this._hideControls();\n      this._map.contextMenu.toggleContextMenuItem('Controls', 'disabled');\n    } else {\n      this._showControls();\n      this._map.contextMenu.toggleContextMenuItem('Controls', 'enabled');\n    }\n  }\n\n  _hideControls() {\n    this._setControlsVisibility('fullscreen', true);\n    this._setControlsVisibility('layercontrol', true);\n    this._setControlsVisibility('reload', true);\n    this._setControlsVisibility('zoom', true);\n    this._setControlsVisibility('geolocation', true);\n    this._setControlsVisibility('scale', true);\n  }\n  _showControls() {\n    this._setControlsVisibility('fullscreen', false);\n    this._setControlsVisibility('layercontrol', false);\n    this._setControlsVisibility('reload', false);\n    this._setControlsVisibility('zoom', false);\n    this._setControlsVisibility('geolocation', true);\n    this._setControlsVisibility('scale', false);\n\n    // prune the controls shown if necessary\n    // this logic could be embedded in _showControls\n    // but would require being able to iterate the domain of supported tokens\n    // for the controlslist\n    if (this._controlsList) {\n      this._controlsList.forEach((value) => {\n        switch (value.toLowerCase()) {\n          case 'nofullscreen':\n            this._setControlsVisibility('fullscreen', true);\n            break;\n          case 'nolayer':\n            this._setControlsVisibility('layercontrol', true);\n            break;\n          case 'noreload':\n            this._setControlsVisibility('reload', true);\n            break;\n          case 'nozoom':\n            this._setControlsVisibility('zoom', true);\n            break;\n          case 'geolocation':\n            this._setControlsVisibility('geolocation', false);\n            break;\n          case 'noscale':\n            this._setControlsVisibility('scale', true);\n            break;\n        }\n      });\n    }\n    if (this._layerControl && this._layerControl._layers.length === 0) {\n      this._layerControl._container.setAttribute('hidden', '');\n    }\n  }\n\n  // delete the map controls that are private properties of this custom element\n  _deleteControls() {\n    delete this._layerControl;\n    delete this._zoomControl;\n    delete this._reloadButton;\n    delete this._fullScreenControl;\n    delete this._geolocationButton;\n    delete this._scaleBar;\n  }\n  // Sets the control's visibility AND all its childrens visibility,\n  // for the control element based on the Boolean hide parameter\n  _setControlsVisibility(control, hide) {\n    let container;\n    switch (control) {\n      case 'zoom':\n        if (this._zoomControl) {\n          container = this._zoomControl._container;\n        }\n        break;\n      case 'reload':\n        if (this._reloadButton) {\n          container = this._reloadButton._container;\n        }\n        break;\n      case 'fullscreen':\n        if (this._fullScreenControl) {\n          container = this._fullScreenControl._container;\n        }\n        break;\n      case 'layercontrol':\n        if (this._layerControl) {\n          container = this._layerControl._container;\n        }\n        break;\n      case 'geolocation':\n        if (this._geolocationButton) {\n          container = this._geolocationButton._container;\n        }\n        break;\n      case 'scale':\n        if (this._scaleBar) {\n          container = this._scaleBar._container;\n        }\n        break;\n    }\n    if (container) {\n      if (hide) {\n        // setting the visibility for all the children of the element\n        [...container.children].forEach((childEl) => {\n          childEl.setAttribute('hidden', '');\n        });\n        container.setAttribute('hidden', '');\n      } else {\n        // setting the visibility for all the children of the element\n        [...container.children].forEach((childEl) => {\n          childEl.removeAttribute('hidden');\n        });\n        container.removeAttribute('hidden');\n      }\n    }\n  }\n  _toggleStatic() {\n    const isStatic = this.hasAttribute('static');\n    if (this._map) {\n      if (isStatic) {\n        this._map.dragging.disable();\n        this._map.touchZoom.disable();\n        this._map.doubleClickZoom.disable();\n        this._map.scrollWheelZoom.disable();\n        this._map.boxZoom.disable();\n        this._map.keyboard.disable();\n        this._zoomControl.disable();\n      } else {\n        this._map.dragging.enable();\n        this._map.touchZoom.enable();\n        this._map.doubleClickZoom.enable();\n        this._map.scrollWheelZoom.enable();\n        this._map.boxZoom.enable();\n        this._map.keyboard.enable();\n        this._zoomControl.enable();\n      }\n    }\n  }\n\n  _dropHandler(event) {\n    event.preventDefault();\n    let text = event.dataTransfer.getData('text');\n    M._pasteLayer(this, text);\n  }\n  _dragoverHandler(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'copy';\n  }\n  _removeEvents() {\n    if (this._map) {\n      this._map.off();\n      this.removeEventListener('drop', this._dropHandler, false);\n      this.removeEventListener('dragover', this._dragoverHandler, false);\n    }\n  }\n  _setUpEvents() {\n    this.addEventListener('drop', this._dropHandler, false);\n    this.addEventListener('dragover', this._dragoverHandler, false);\n    this.addEventListener(\n      'change',\n      function (e) {\n        if (e.target.tagName === 'LAYER-') {\n          this.dispatchEvent(\n            new CustomEvent('layerchange', {\n              details: { target: this, originalEvent: e }\n            })\n          );\n        }\n      },\n      false\n    );\n\n    let host =\n      this.getRootNode() instanceof ShadowRoot\n        ? this.getRootNode().host\n        : this.parentElement;\n    host.addEventListener('keyup', function (e) {\n      if (\n        e.keyCode === 9 &&\n        document.activeElement.className === 'mapml-web-map'\n      ) {\n        // document.activeElement is div.mapml-web-map, not <map>\n        document.activeElement.dispatchEvent(\n          new CustomEvent('mapfocused', { detail: { target: this } })\n        );\n      }\n    });\n    // pasting layer-, links and geojson using Ctrl+V\n    this.addEventListener('keydown', function (e) {\n      if (e.keyCode === 86 && e.ctrlKey) {\n        navigator.clipboard.readText().then((layer) => {\n          M._pasteLayer(this, layer);\n        });\n        // Prevents default spacebar event on all of web-map\n      } else if (\n        e.keyCode === 32 &&\n        document.activeElement.shadowRoot.activeElement.nodeName !== 'INPUT'\n      ) {\n        e.preventDefault();\n        this._map.fire('keypress', { originalEvent: e });\n      }\n    });\n    host.addEventListener('mousedown', function (e) {\n      if (document.activeElement.className === 'mapml-web-map') {\n        document.activeElement.dispatchEvent(\n          new CustomEvent('mapfocused', { detail: { target: this } })\n        );\n      }\n    });\n\n    this._map.on(\n      'locationfound',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('maplocationfound', {\n            detail: { latlng: e.latlng, accuracy: e.accuracy }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'locationerror',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('locationerror', { detail: { error: e.message } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'load',\n      function () {\n        this.dispatchEvent(\n          new CustomEvent('load', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'preclick',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('preclick', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'click',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('click', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'dblclick',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('dblclick', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'mousemove',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('mousemove', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'mouseover',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('mouseover', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'mouseout',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('mouseout', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'mousedown',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('mousedown', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'mouseup',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('mouseup', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'contextmenu',\n      function (e) {\n        this.dispatchEvent(\n          new CustomEvent('contextmenu', {\n            detail: {\n              lat: e.latlng.lat,\n              lon: e.latlng.lng,\n              x: e.containerPoint.x,\n              y: e.containerPoint.y\n            }\n          })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'movestart',\n      function () {\n        this.dispatchEvent(\n          new CustomEvent('movestart', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'move',\n      function () {\n        this.dispatchEvent(\n          new CustomEvent('move', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'moveend',\n      function () {\n        this._updateMapCenter();\n        this._addToHistory();\n        this.dispatchEvent(\n          new CustomEvent('map-moveend', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'zoomstart',\n      function () {\n        this.dispatchEvent(\n          new CustomEvent('zoomstart', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'zoom',\n      function () {\n        this.dispatchEvent(\n          new CustomEvent('zoom', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    this._map.on(\n      'zoomend',\n      function () {\n        this._updateMapCenter();\n        this.dispatchEvent(\n          new CustomEvent('zoomend', { detail: { target: this } })\n        );\n      },\n      this\n    );\n    const setMapMinAndMaxZoom = ((e) => {\n      this.whenLayersReady().then(() => {\n        if (e && e.layer._layerEl) {\n          this._map.setMaxZoom(this.extent.zoom.maxZoom);\n          this._map.setMinZoom(this.extent.zoom.minZoom);\n        }\n      });\n    }).bind(this);\n    this.whenLayersReady().then(() => {\n      this._map.setMaxZoom(this.extent.zoom.maxZoom);\n      this._map.setMinZoom(this.extent.zoom.minZoom);\n      this._map.on('layeradd layerremove', setMapMinAndMaxZoom, this);\n    });\n    this.addEventListener('fullscreenchange', function (event) {\n      if (document.fullscreenElement === null) {\n        // full-screen mode has been exited\n        this._map.contextMenu.setViewFullScreenInnerHTML('view');\n      } else {\n        this._map.contextMenu.setViewFullScreenInnerHTML('exit');\n      }\n    });\n    this.addEventListener('keydown', function (event) {\n      if (document.activeElement.className === 'mapml-web-map') {\n        // Check if Ctrl+R is pressed and map is focused\n        if (event.ctrlKey && event.keyCode === 82) {\n          // Prevent default browser behavior\n          event.preventDefault();\n          this.reload();\n        } else if (event.altKey && event.keyCode === 39) {\n          // Prevent default browser behavior\n          event.preventDefault();\n          this.forward();\n        } else if (event.altKey && event.keyCode === 37) {\n          // Prevent default browser behavior\n          event.preventDefault();\n          this.back();\n        }\n      }\n    });\n  }\n\n  locate(options) {\n    //options: https://leafletjs.com/reference.html#locate-options\n    if (this._geolocationButton) {\n      this._geolocationButton.stop();\n    }\n    if (options) {\n      if (options.zoomTo) {\n        options.setView = options.zoomTo;\n        delete options.zoomTo;\n      }\n      this._map.locate(options);\n    } else {\n      this._map.locate({ setView: true, maxZoom: 16 });\n    }\n  }\n\n  toggleDebug() {\n    if (this._debug) {\n      this._debug.remove();\n      this._debug = undefined;\n    } else {\n      this._debug = M.debugOverlay().addTo(this._map);\n    }\n  }\n\n  _changeWidth(width) {\n    if (this._container) {\n      this._container.style.width = width + 'px';\n      document.querySelector('[is=\"web-map\"]').style.width = width + 'px';\n    }\n    if (this._map) {\n      this._map.invalidateSize(false);\n    }\n  }\n  _changeHeight(height) {\n    if (this._container) {\n      this._container.style.height = height + 'px';\n      document.querySelector('[is=\"web-map\"]').style.height = height + 'px';\n    }\n    if (this._map) {\n      this._map.invalidateSize(false);\n    }\n  }\n  zoomTo(lat, lon, zoom) {\n    zoom = Number.isInteger(+zoom) ? +zoom : this.zoom;\n    let location = new L.LatLng(+lat, +lon);\n    this._map.setView(location, zoom);\n    this.zoom = zoom;\n    this.lat = location.lat;\n    this.lon = location.lng;\n  }\n  _updateMapCenter() {\n    // remember to tell Leaflet event handler that 'this' in here refers to\n    //  something other than the map in this case the custom polymer element\n    this.lat = this._map.getCenter().lat;\n    this.lon = this._map.getCenter().lng;\n    this.zoom = this._map.getZoom();\n  }\n  _resetHistory() {\n    this._history = [];\n    this._historyIndex = -1;\n    this._traversalCall = false;\n    // weird but ok\n    this._addToHistory();\n  }\n  /**\n   * Adds to the maps history on moveends\n   * @private\n   */\n  _addToHistory() {\n    if (this._traversalCall > 0) {\n      // this._traversalCall tracks how many consecutive moveends to ignore from history\n      this._traversalCall--; // this is useful for ignoring moveends corresponding to back, forward and reload\n      return;\n    }\n\n    let mapLocation = this._map.getPixelBounds().getCenter();\n    let location = {\n      zoom: this._map.getZoom(),\n      x: mapLocation.x,\n      y: mapLocation.y\n    };\n    this._historyIndex++;\n    this._history.splice(this._historyIndex, 0, location);\n    // Remove future history and overwrite it when map pan/zoom while inside history\n    if (this._historyIndex + 1 !== this._history.length) {\n      this._history.length = this._historyIndex + 1;\n    }\n    if (this._historyIndex === 0) {\n      // when at initial state of map, disable back, forward, and reload items\n      this._map.contextMenu.toggleContextMenuItem('Back', 'disabled'); // back contextmenu item\n      this._map.contextMenu.toggleContextMenuItem('Forward', 'disabled'); // forward contextmenu item\n      this._map.contextMenu.toggleContextMenuItem('Reload', 'disabled'); // reload contextmenu item\n      this._reloadButton?.disable();\n    } else {\n      this._map.contextMenu.toggleContextMenuItem('Back', 'enabled'); // back contextmenu item\n      this._map.contextMenu.toggleContextMenuItem('Forward', 'disabled'); // forward contextmenu item\n      this._map.contextMenu.toggleContextMenuItem('Reload', 'enabled'); // reload contextmenu item\n      this._reloadButton?.enable();\n    }\n  }\n  /**\n   * Allow user to move back in history\n   */\n  back() {\n    let history = this._history;\n    let curr = history[this._historyIndex];\n\n    if (this._historyIndex > 0) {\n      this._map.contextMenu.toggleContextMenuItem('Forward', 'enabled'); // forward contextmenu item\n      this._historyIndex--;\n      let prev = history[this._historyIndex];\n      // Disable back, reload contextmenu item when at the end of history\n      if (this._historyIndex === 0) {\n        this._map.contextMenu.toggleContextMenuItem('Back', 'disabled'); // back contextmenu item\n        this._map.contextMenu.toggleContextMenuItem('Reload', 'disabled'); // reload contextmenu item\n        this._reloadButton?.disable();\n      }\n\n      if (prev.zoom !== curr.zoom) {\n        this._traversalCall = 2; // allows the next 2 moveends to be ignored from history\n\n        let currScale = this._map.options.crs.scale(curr.zoom); // gets the scale of the current zoom level\n        let prevScale = this._map.options.crs.scale(prev.zoom); // gets the scale of the previous zoom level\n\n        let scale = currScale / prevScale; // used to convert the previous pixel location to be in terms of the current zoom level\n\n        this._map.panBy([prev.x * scale - curr.x, prev.y * scale - curr.y], {\n          animate: false\n        });\n        this._map.setZoom(prev.zoom);\n      } else {\n        this._traversalCall = 1;\n        this._map.panBy([prev.x - curr.x, prev.y - curr.y]);\n      }\n    }\n  }\n\n  /**\n   * Allows user to move forward in history\n   */\n  forward() {\n    let history = this._history;\n    let curr = history[this._historyIndex];\n    if (this._historyIndex < history.length - 1) {\n      this._map.contextMenu.toggleContextMenuItem('Back', 'enabled'); // back contextmenu item\n      this._map.contextMenu.toggleContextMenuItem('Reload', 'enabled'); // reload contextmenu item\n      this._reloadButton?.enable();\n      this._historyIndex++;\n      let next = history[this._historyIndex];\n      // disable forward contextmenu item, when at the end of forward history\n      if (this._historyIndex + 1 === this._history.length) {\n        this._map.contextMenu.toggleContextMenuItem('Forward', 'disabled'); // forward contextmenu item\n      }\n\n      if (next.zoom !== curr.zoom) {\n        this._traversalCall = 2; // allows the next 2 moveends to be ignored from history\n\n        let currScale = this._map.options.crs.scale(curr.zoom); // gets the scale of the current zoom level\n        let nextScale = this._map.options.crs.scale(next.zoom); // gets the scale of the next zoom level\n\n        let scale = currScale / nextScale; // used to convert the next pixel location to be in terms of the current zoom level\n\n        this._map.panBy([next.x * scale - curr.x, next.y * scale - curr.y], {\n          animate: false\n        });\n        this._map.setZoom(next.zoom);\n      } else {\n        this._traversalCall = 1;\n        this._map.panBy([next.x - curr.x, next.y - curr.y]);\n      }\n    }\n  }\n\n  /**\n   * Allows the user to reload/reset the map's location to it's initial location\n   */\n  reload() {\n    let initialLocation = this._history.shift();\n    let mapLocation = this._map.getPixelBounds().getCenter();\n    let curr = {\n      zoom: this._map.getZoom(),\n      x: mapLocation.x,\n      y: mapLocation.y\n    };\n\n    this._map.contextMenu.toggleContextMenuItem('Back', 'disabled'); // back contextmenu item\n    this._map.contextMenu.toggleContextMenuItem('Forward', 'disabled'); // forward contextmenu item\n    this._map.contextMenu.toggleContextMenuItem('Reload', 'disabled'); // reload contextmenu item\n    this._reloadButton?.disable();\n\n    this._history = [initialLocation];\n    this._historyIndex = 0;\n\n    if (initialLocation.zoom !== curr.zoom) {\n      this._traversalCall = 2; // ignores the next 2 moveend events\n\n      let currScale = this._map.options.crs.scale(curr.zoom); // gets the scale of the current zoom level\n      let initScale = this._map.options.crs.scale(initialLocation.zoom); // gets the scale of the initial location's zoom\n\n      let scale = currScale / initScale;\n\n      this._map.panBy(\n        [\n          initialLocation.x * scale - curr.x,\n          initialLocation.y * scale - curr.y\n        ],\n        { animate: false }\n      );\n      this._map.setZoom(initialLocation.zoom);\n    } else {\n      // if it's on the same zoom level as the initial location, no need to calculate scales\n      this._traversalCall = 1;\n      this._map.panBy([initialLocation.x - curr.x, initialLocation.y - curr.y]);\n    }\n    this._map.getContainer().focus();\n  }\n\n  _toggleFullScreen() {\n    this._map.toggleFullscreen();\n  }\n\n  viewSource() {\n    let blob = new Blob([this._source], { type: 'text/plain' }),\n      url = URL.createObjectURL(blob);\n    window.open(url);\n    URL.revokeObjectURL(url);\n  }\n\n  defineCustomProjection(jsonTemplate) {\n    let t = JSON.parse(jsonTemplate);\n    if (\n      t === undefined ||\n      !t.proj4string ||\n      !t.projection ||\n      !t.resolutions ||\n      !t.origin ||\n      !t.bounds\n    )\n      throw new Error('Incomplete TCRS Definition');\n    if (t.projection.indexOf(':') >= 0)\n      throw new Error('\":\" is not permitted in projection name');\n    if (M[t.projection.toUpperCase()]) return t.projection.toUpperCase();\n    let tileSize = [256, 512, 1024, 2048, 4096].includes(t.tilesize)\n      ? t.tilesize\n      : M.TILE_SIZE;\n\n    M[t.projection] = new L.Proj.CRS(t.projection, t.proj4string, {\n      origin: t.origin,\n      resolutions: t.resolutions,\n      bounds: L.bounds(t.bounds),\n      crs: {\n        tcrs: {\n          horizontal: {\n            name: 'x',\n            min: 0,\n            max: (zoom) =>\n              Math.round(\n                M[t.projection].options.bounds.getSize().x /\n                  M[t.projection].options.resolutions[zoom]\n              )\n          },\n          vertical: {\n            name: 'y',\n            min: 0,\n            max: (zoom) =>\n              Math.round(\n                M[t.projection].options.bounds.getSize().y /\n                  M[t.projection].options.resolutions[zoom]\n              )\n          },\n          bounds: (zoom) =>\n            L.bounds(\n              [\n                M[t.projection].options.crs.tcrs.horizontal.min,\n                M[t.projection].options.crs.tcrs.vertical.min\n              ],\n              [\n                M[t.projection].options.crs.tcrs.horizontal.max(zoom),\n                M[t.projection].options.crs.tcrs.vertical.max(zoom)\n              ]\n            )\n        },\n        pcrs: {\n          horizontal: {\n            name: 'easting',\n            get min() {\n              return M[t.projection].options.bounds.min.x;\n            },\n            get max() {\n              return M[t.projection].options.bounds.max.x;\n            }\n          },\n          vertical: {\n            name: 'northing',\n            get min() {\n              return M[t.projection].options.bounds.min.y;\n            },\n            get max() {\n              return M[t.projection].options.bounds.max.y;\n            }\n          },\n          get bounds() {\n            return M[t.projection].options.bounds;\n          }\n        },\n        gcrs: {\n          horizontal: {\n            name: 'longitude',\n            // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n            get min() {\n              return M[t.projection].unproject(M.OSMTILE.options.bounds.min)\n                .lng;\n            },\n            get max() {\n              return M[t.projection].unproject(M.OSMTILE.options.bounds.max)\n                .lng;\n            }\n          },\n          vertical: {\n            name: 'latitude',\n            // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n            get min() {\n              return M[t.projection].unproject(M.OSMTILE.options.bounds.min)\n                .lat;\n            },\n            get max() {\n              return M[t.projection].unproject(M.OSMTILE.options.bounds.max)\n                .lat;\n            }\n          },\n          get bounds() {\n            return L.latLngBounds(\n              [\n                M[t.projection].options.crs.gcrs.vertical.min,\n                M[t.projection].options.crs.gcrs.horizontal.min\n              ],\n              [\n                M[t.projection].options.crs.gcrs.vertical.max,\n                M[t.projection].options.crs.gcrs.horizontal.max\n              ]\n            );\n          }\n        },\n        map: {\n          horizontal: {\n            name: 'i',\n            min: 0,\n            max: (map) => map.getSize().x\n          },\n          vertical: {\n            name: 'j',\n            min: 0,\n            max: (map) => map.getSize().y\n          },\n          bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n        },\n        tile: {\n          horizontal: {\n            name: 'i',\n            min: 0,\n            max: tileSize\n          },\n          vertical: {\n            name: 'j',\n            min: 0,\n            max: tileSize\n          },\n          get bounds() {\n            return L.bounds(\n              [\n                M[t.projection].options.crs.tile.horizontal.min,\n                M[t.projection].options.crs.tile.vertical.min\n              ],\n              [\n                M[t.projection].options.crs.tile.horizontal.max,\n                M[t.projection].options.crs.tile.vertical.max\n              ]\n            );\n          }\n        },\n        tilematrix: {\n          horizontal: {\n            name: 'column',\n            min: 0,\n            max: (zoom) =>\n              Math.round(\n                M[t.projection].options.crs.tcrs.horizontal.max(zoom) /\n                  M[t.projection].options.crs.tile.bounds.getSize().x\n              )\n          },\n          vertical: {\n            name: 'row',\n            min: 0,\n            max: (zoom) =>\n              Math.round(\n                M[t.projection].options.crs.tcrs.vertical.max(zoom) /\n                  M[t.projection].options.crs.tile.bounds.getSize().y\n              )\n          },\n          bounds: (zoom) =>\n            L.bounds(\n              [\n                M[t.projection].options.crs.tilematrix.horizontal.min,\n                M[t.projection].options.crs.tilematrix.vertical.min\n              ],\n              [\n                M[t.projection].options.crs.tilematrix.horizontal.max(zoom),\n                M[t.projection].options.crs.tilematrix.vertical.max(zoom)\n              ]\n            )\n        }\n      }\n    }); //creates crs using L.Proj\n    M[t.projection.toUpperCase()] = M[t.projection]; //adds the projection uppercase to global M\n    return t.projection;\n  }\n  whenReady() {\n    return new Promise((resolve, reject) => {\n      let interval, failureTimer;\n      if (this._map) {\n        resolve();\n      } else {\n        let viewer = this;\n        interval = setInterval(testForMap, 200, viewer);\n        failureTimer = setTimeout(mapNotDefined, 5000);\n      }\n      function testForMap(viewer) {\n        if (viewer._map) {\n          clearInterval(interval);\n          clearTimeout(failureTimer);\n          resolve();\n        }\n      }\n      function mapNotDefined() {\n        clearInterval(interval);\n        clearTimeout(failureTimer);\n        reject('Timeout reached waiting for map to be ready');\n      }\n    });\n  }\n  whenLayersReady() {\n    let layersReady = [];\n    // check if all the children elements (map-extent, map-feature) of all layer- are ready\n    for (let layer of [...this.layers]) {\n      layersReady.push(layer.whenReady());\n    }\n    return Promise.allSettled(layersReady);\n  }\n  whenProjectionDefined(projection) {\n    return new Promise((resolve, reject) => {\n      let interval, failureTimer;\n      if (M[projection]) {\n        resolve();\n      } else {\n        interval = setInterval(testForProjection, 200, projection);\n        failureTimer = setTimeout(projectionNotDefined, 5000);\n      }\n      function testForProjection(p) {\n        if (M[p]) {\n          clearInterval(interval);\n          clearTimeout(failureTimer);\n          resolve();\n        }\n      }\n      function projectionNotDefined() {\n        clearInterval(interval);\n        clearTimeout(failureTimer);\n        reject('Timeout reached waiting for projection to be defined');\n      }\n    });\n  }\n  geojson2mapml(json, options = {}) {\n    if (options.projection === undefined) {\n      options.projection = this.projection;\n    }\n    let geojsonLayer = M.geojson2mapml(json, options);\n    this.appendChild(geojsonLayer);\n    return geojsonLayer;\n  }\n\n  _ready() {\n    if (this.hasAttribute('name')) {\n      var name = this.getAttribute('name');\n      if (name) {\n        this.poster = document.querySelector(\n          'img[usemap=' + '\"#' + name + '\"]'\n        );\n        // firefox has an issue where the attribution control's use of\n        // _container.innerHTML does not work properly if the engine is throwing\n        // exceptions because there are no area element children of the image map\n        // for firefox only, a workaround is to actually remove the image...\n        if (this.poster) {\n          if (L.Browser.gecko) {\n            this.poster.removeAttribute('usemap');\n          }\n          this._container.appendChild(this.poster);\n        }\n      }\n    }\n  }\n}\n// need to provide options { extends: ... }  for custom built-in elements\nwindow.customElements.define('web-map', WebMap, { extends: 'map' });\nwindow.customElements.define('layer-', MapLayer);\nwindow.customElements.define('map-area', MapArea, { extends: 'area' });\nwindow.customElements.define('map-caption', MapCaption);\nwindow.customElements.define('map-feature', MapFeature);\nwindow.customElements.define('map-extent', MapExtent);\nwindow.customElements.define('map-input', MapInput);\nwindow.customElements.define('map-select', MapSelect);\nwindow.customElements.define('map-link', MapLink);\nwindow.customElements.define('map-style', MapStyle);\n"],"names":["MapLayer","MapArea","MapCaption","MapFeature","MapExtent","MapInput","MapSelect","MapLink","MapStyle","WebMap","HTMLMapElement","observedAttributes","controls","this","hasAttribute","value","Boolean","setAttribute","removeAttribute","controlsList","_controlsList","width","window","getComputedStyle","replace","val","height","lat","getAttribute","lon","projection","whenProjectionDefined","then","catch","Error","zoom","parsedVal","parseInt","isNaN","layers","getElementsByTagName","areas","extent","let","map","_map","pcrsBounds","M","pixelToPCRSBounds","getPixelBounds","getZoom","options","formattedExtent","_convertAndFormatPCRS","crs","minZoom","Infinity","maxZoom","i","length","getMinZoom","getMaxZoom","static","constructor","super","_source","outerHTML","_history","_historyIndex","_traversalCall","connectedCallback","_initShadowRoot","DOMTokenList","s","wpx","hpx","w","h","_changeWidth","_changeHeight","_createMap","_toggleStatic","mapcaption","querySelector","setTimeout","innerHTML","mapCaptionObserver","MutationObserver","observe","childList","tmpl","document","createElement","URL","import","meta","url","href","rootDiv","classList","add","shadowRoot","attachShadow","mode","_container","insertAdjacentHTML","mapDefaultCSS","id","shadowRootCSS","hideElementsCSS","appendChild","content","cloneNode","getRootNode","ShadowRoot","getElementById","prepend","head","insertAdjacentElement","name","L","center","LatLng","resolutions","query","contextMenu","announceMovement","featureIndex","mapEl","zoomControl","_addToHistory","_createControls","_toggleControls","_crosshair","crosshair","addTo","featureIndexOverlayOption","_featureIndexOverlay","featureIndexOverlay","poster","Browser","gecko","_setUpEvents","disconnectedCallback","_removeEvents","firstChild","removeChild","remove","_deleteControls","adoptedCallback","attributeChangedCallback","oldValue","newValue","valueSet","_hideControls","_showControls","connect","layersReady","disable","layer","querySelectorAll","reAttach","push","whenReady","Promise","allSettled","zoomTo","enable","dispatchEvent","CustomEvent","bind","_resetHistory","_debug","toggleDebug","mapSize","getSize","y","totalSize","_layerControl","layerControl","collapsed","on","collapse","scaleValue","announceScale","metric","imperial","_scaleBar","scaleBar","_zoomControl","control","_reloadButton","reloadButton","_fullScreenControl","fullscreenButton","_geolocationButton","geolocationButton","toggleContextMenuItem","_setControlsVisibility","forEach","toLowerCase","_layers","hide","container","children","childEl","isStatic","dragging","touchZoom","doubleClickZoom","scrollWheelZoom","boxZoom","keyboard","_dropHandler","event","preventDefault","text","dataTransfer","getData","_pasteLayer","_dragoverHandler","dropEffect","off","removeEventListener","addEventListener","e","target","tagName","details","originalEvent","host","parentElement","keyCode","activeElement","className","detail","ctrlKey","navigator","clipboard","readText","nodeName","fire","latlng","accuracy","error","message","lng","x","containerPoint","_updateMapCenter","setMapMinAndMaxZoom","whenLayersReady","_layerEl","setMaxZoom","setMinZoom","fullscreenElement","setViewFullScreenInnerHTML","reload","altKey","forward","back","locate","stop","setView","undefined","debugOverlay","style","invalidateSize","Number","isInteger","location","getCenter","mapLocation","splice","prev","history","curr","scale","panBy","animate","setZoom","next","initialLocation","shift","getContainer","focus","_toggleFullScreen","toggleFullscreen","viewSource","blob","Blob","type","createObjectURL","open","revokeObjectURL","defineCustomProjection","jsonTemplate","t","JSON","parse","proj4string","origin","bounds","indexOf","toUpperCase","tileSize","includes","tilesize","TILE_SIZE","Proj","CRS","tcrs","horizontal","min","max","Math","round","vertical","pcrs","gcrs","unproject","OSMTILE","latLngBounds","point","tile","tilematrix","resolve","reject","interval","failureTimer","setInterval","viewer","clearInterval","clearTimeout","p","geojson2mapml","json","geojsonLayer","_ready","customElements","define","extends"],"mappings":"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"}